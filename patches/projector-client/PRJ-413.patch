From fbc0ef1fc1ac79b628ec100c760d1f3fd499e4c6 Mon Sep 17 00:00:00 2001
From: Vladyslav Zhukovskyi <vzhukovs@redhat.com>
Date: Fri, 2 Apr 2021 03:34:46 +0300
Subject: [PATCH] PRJ-413 Check if current window runs inside iframe

Signed-off-by: Vladyslav Zhukovskyi <vzhukovs@redhat.com>
---
 .../projector/client/web/input/layout/KeyboardApiLayout.kt       | 1 +
 1 file changed, 1 insertion(+)

diff --git a/projector-client-web/src/main/kotlin/org/jetbrains/projector/client/web/input/layout/KeyboardApiLayout.kt b/projector-client-web/src/main/kotlin/org/jetbrains/projector/client/web/input/layout/KeyboardApiLayout.kt
index f4d45ae..12fd517 100644
--- a/projector-client-web/src/main/kotlin/org/jetbrains/projector/client/web/input/layout/KeyboardApiLayout.kt
+++ b/projector-client-web/src/main/kotlin/org/jetbrains/projector/client/web/input/layout/KeyboardApiLayout.kt
@@ -31,6 +31,7 @@ import org.jetbrains.projector.common.protocol.data.VK
 object KeyboardApiLayout {
 
   suspend fun getVirtualKey(code: String): VK? {
+    if (window != window.parent) return null
     val keyboard = window.navigator.keyboard ?: return null
     val currentLayout = keyboard.getLayoutMap().await()
     val currentSymbolOnKeyboard = currentLayout.get(code)?.single()
